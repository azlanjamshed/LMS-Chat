<!DOCTYPE html>
<html>

<head>
    <title>LMS Chat - Rooms</title>
</head>

<body>
    <h2>ğŸ« LMS Class Chat</h2>

    <select id="roomSelect">
        <option value="class_101">Class 101 (Math)</option>
        <option value="class_102">Class 102 (Science)</option>
        <option value="class_103">Class 103 (English)</option>
    </select>
    <button onclick="joinRoom()">Join Class</button>

    <div id="currentRoom"></div>
    <div id="userList"></div>
    <input id="messageInput" placeholder="Type message..." />
    <button onclick="sendMessage()">Send</button>
    <ul id="messages"></ul>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io();
        let currentRoom = null;

        function joinRoom() {
            currentRoom = document.getElementById('roomSelect').value;
            socket.emit('join-room', currentRoom);
            document.getElementById('currentRoom').innerHTML =
                `<h3>ğŸ“š In: ${currentRoom}</h3>`;
        }

        function sendMessage() {
            const input = document.getElementById('messageInput');
            const msg = input.value;
            if (msg && currentRoom) {
                socket.emit('chat-message', { message: msg, roomId: currentRoom });
                input.value = '';
            }
        }

        socket.on('chat-message', (data) => {
            if (data.roomId === currentRoom) {
                const li = document.createElement('li');
                li.textContent = `${data.message}`;
                document.getElementById('messages').appendChild(li);
            }
        });
        socket.on('room-users', (data) => {
            if (data.roomId === currentRoom) {
                document.getElementById('userList').innerHTML =
                    `ğŸ‘¥ ${data.userCount} students/teachers online`;
            }
        });
    </script>
</body>

</html>